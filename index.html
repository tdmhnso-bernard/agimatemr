<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TDMH AGIMAT Audit Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print { 
            .no-print { display: none !important; } 
            body { background-color: white; } 
            .tab-content { display: block !important; border: 1px solid #ccc; margin-bottom: 2rem; page-break-inside: avoid; }
        }
        .section-card { border-left: 6px solid #1e40af; background: white; margin-bottom: 1.25rem; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .tab-btn.active { border-bottom: 4px solid #1e40af; color: #1e40af; font-weight: bold; background-color: #f8fafc; }
        .mandatory-notice { border: 2px solid #dc2626; background-color: #fef2f2; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 2rem; }
        .auth-check { border: 1px solid #e2e8f0; background-color: #f8fafc; padding: 0.75rem; border-radius: 0.375rem; margin-bottom: 1rem; border-left: 4px solid #ef4444; }
        .loading { opacity: 0.5; pointer-events: none; cursor: wait; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-800">

    <div class="max-w-6xl mx-auto py-8 px-4">
        <div class="mandatory-notice">
            <h1 class="text-2xl font-bold text-red-700 uppercase mb-2">‚ö†Ô∏è MANDATORY COMPLIANCE NOTICE</h1>
            <p class="text-sm leading-relaxed text-red-900">
                Pursuant to **Memo Ref: 2026-TDMH-PHIC**, all AGIMAT PhilHealth data encoding must follow the strictly defined hospital workflow. 
                Failure to complete any of the following steps‚Äîspecifically <strong>Patient Consent, Clinical Abstract, and Meta-Data encoding</strong>‚Äîwill result in 
                unsent E-Claims and rejected reimbursements. <strong>Strict sanctions</strong> will be applied to the responsible staff/department for non-compliance leading to financial loss.
            </p>
        </div>

        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-blue-900 uppercase">Taytay Doctors Multispecialty Hospital</h2>
            <h3 class="text-lg font-semibold text-slate-600 uppercase tracking-widest">AGIMAT PhilHealth Audit Portal (Internal)</h3>
        </div>

        <form id="auditForm">
            <div class="bg-blue-900 text-white p-6 rounded-t-lg grid grid-cols-1 md:grid-cols-4 gap-4 mb-1">
                <div class="md:col-span-1">
                    <label class="block text-[10px] uppercase font-bold mb-1">Auditor Name</label>
                    <input name="auditor" type="text" class="w-full bg-blue-800 border-none p-2 rounded text-white" placeholder="Required" required>
                </div>
                <div class="md:col-span-1">
                    <label class="block text-[10px] uppercase font-bold mb-1">Staff Audited</label>
                    <input name="staff_audited" type="text" class="w-full bg-blue-800 border-none p-2 rounded text-white" placeholder="Name" required>
                </div>
                <div class="md:col-span-2">
                    <label class="block text-[10px] uppercase font-bold mb-1">Patient Encounter Number</label>
                    <input name="encounter_no" type="text" class="w-full bg-blue-800 border-none p-2 rounded text-white" placeholder="Enter Encounter #" required>
                </div>
            </div>

            <div class="flex border-b bg-white no-print overflow-x-auto sticky top-0 z-10">
                <button type="button" onclick="showTab('admitting')" class="tab-btn active px-6 py-4 text-xs font-bold uppercase tracking-tighter transition-all">1. Admitting/Clerk</button>
                <button type="button" onclick="showTab('nurses')" class="tab-btn px-6 py-4 text-xs font-bold uppercase tracking-tighter transition-all">2. Nurses</button>
                <button type="button" onclick="showTab('rod')" class="tab-btn px-6 py-4 text-xs font-bold uppercase tracking-tighter transition-all">3. Resident (ROD)</button>
                <button type="button" onclick="showTab('laboratory')" class="tab-btn px-6 py-4 text-xs font-bold uppercase tracking-tighter transition-all">4. Laboratory</button>
                <button type="button" onclick="showTab('radiology')" class="tab-btn px-6 py-4 text-xs font-bold uppercase tracking-tighter transition-all">5. Radiology</button>
            </div>

            <div class="bg-white p-8 shadow-xl rounded-b-lg mb-8">
                
                <div id="admitting" class="tab-content space-y-4">
                    <h4 class="text-blue-800 font-bold border-b pb-2">DEPARTMENT: ADMITTING / BILLING</h4>
                    <div class="auth-check">
                        <label class="flex items-center"><input name="acc_admitting" type="checkbox" value="YES" class="w-4 h-4 mr-2" required> Active AGIMAT Admitting Account Verified?</label>
                    </div>
                    <div class="space-y-3">
                        <label class="flex items-center p-3 border rounded"><input name="adm_1_create" type="checkbox" value="YES" class="mr-3"> 1. Create Patient Data completed?</label>
                        <label class="flex items-center p-3 border rounded"><input name="adm_2_unlock" type="checkbox" value="YES" class="mr-3"> 2. Unlock Record & Sign/Save Consent?</label>
                        <label class="flex items-center p-3 border rounded bg-blue-50 border-blue-100 font-bold">
                            <input name="adm_4_philhealth" type="checkbox" value="YES" class="mr-3"> 
                            4. Financial > "+" > Public Insurance > PhilHealth Verification Saved?
                        </label>
                    </div>
                </div>

                <div id="nurses" class="tab-content hidden space-y-4">
                    <h4 class="text-blue-800 font-bold border-b pb-2">DEPARTMENT: NURSING SERVICE</h4>
                    <div class="auth-check">
                        <label class="flex items-center"><input name="acc_nursing" type="checkbox" value="YES" class="w-4 h-4 mr-2" required> Active AGIMAT Nursing Account Verified?</label>
                    </div>
                    <div class="space-y-4">
                        <label class="flex items-center p-3 border rounded"><input name="nur_3_episode" type="checkbox" value="YES" class="mr-3"> 3. New Episode > Admission & Chief Complaint Filled?</label>
                        
                        <div class="bg-slate-50 p-4 rounded border">
                            <p class="text-xs font-bold uppercase mb-3">5. Patient Vital Signs (Filter: Observation):</p>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-[11px]">
                                <label class="flex items-center"><input name="v_wt" type="checkbox" value="YES" class="mr-1"> Weight</label>
                                <label class="flex items-center"><input name="v_ht" type="checkbox" value="YES" class="mr-1"> Height</label>
                                <label class="flex items-center"><input name="v_temp" type="checkbox" value="YES" class="mr-1"> Temp</label>
                                <label class="flex items-center"><input name="v_pulse" type="checkbox" value="YES" class="mr-1"> Pulse</label>
                                <label class="flex items-center"><input name="v_rr" type="checkbox" value="YES" class="mr-1"> Resp Rate</label>
                                <label class="flex items-center"><input name="v_bp" type="checkbox" value="YES" class="mr-1"> BP</label>
                                <label class="flex items-center"><input name="v_o2" type="checkbox" value="YES" class="mr-1"> O2 Sat</label>
                                <label class="flex items-center"><input name="v_gcs" type="checkbox" value="YES" class="mr-1"> GCS</label>
                            </div>
                        </div>

                        <div class="p-4 bg-pink-50 border border-pink-100 rounded">
                            <p class="text-xs font-bold text-pink-800 uppercase mb-2">Obstetric Index (If Female):</p>
                            <div class="grid grid-cols-3 md:grid-cols-6 gap-2">
                                <label class="flex flex-col items-center text-[10px] bg-white p-1 border rounded"><span class="font-bold">G</span><input name="ob_g" type="checkbox" value="YES"></label>
                                <label class="flex flex-col items-center text-[10px] bg-white p-1 border rounded"><span class="font-bold">P</span><input name="ob_p" type="checkbox" value="YES"></label>
                                <label class="flex flex-col items-center text-[10px] bg-white p-1 border rounded"><span class="font-bold">T</span><input name="ob_t" type="checkbox" value="YES"></label>
                                <label class="flex flex-col items-center text-[10px] bg-white p-1 border rounded"><span class="font-bold">P</span><input name="ob_pt" type="checkbox" value="YES"></label>
                                <label class="flex flex-col items-center text-[10px] bg-white p-1 border rounded"><span class="font-bold">A</span><input name="ob_a" type="checkbox" value="YES"></label>
                                <label class="flex flex-col items-center text-[10px] bg-white p-1 border rounded"><span class="font-bold">L</span><input name="ob_l" type="checkbox" value="YES"></label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="rod" class="tab-content hidden space-y-4">
                    <h4 class="text-blue-800 font-bold border-b pb-2">DEPARTMENT: RESIDENT ON DUTY (MD)</h4>
                    <div class="auth-check">
                        <label class="flex items-center"><input name="acc_rod" type="checkbox" value="YES" class="w-4 h-4 mr-2" required> Active AGIMAT Physician Account Verified?</label>
                    </div>
                    <div class="space-y-4">
                        <label class="flex items-center p-3 border rounded"><input name="rod_3_ros" type="checkbox" value="YES" class="mr-3"> 3. Review of Systems (Symptoms/Diagnoses) Encoded?</label>
                        
                        <div class="p-4 border rounded bg-blue-50">
                            <p class="text-xs font-bold mb-3 uppercase">6. Clinical Abstract (Document > Notes + > Clinical Abstract):</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-xs">
                                <label class="flex items-center"><input name="rod_title" type="checkbox" value="YES" class="mr-2"> Title: Name of Physician</label>
                                <label class="flex items-center"><input name="rod_cc" type="checkbox" value="YES" class="mr-2"> Chief Complaints Filled</label>
                                <label class="flex items-center"><input name="rod_hpi" type="checkbox" value="YES" class="mr-2"> History of Present Illness</label>
                                <label class="flex items-center"><input name="rod_clin_hist" type="checkbox" value="YES" class="mr-2"> Clinical History</label>
                                <label class="flex items-center"><input name="rod_procedures" type="checkbox" value="YES" class="mr-2"> Surgical/Diagnostic Procedures</label>
                                <label class="flex items-center"><input name="rod_lab_findings" type="checkbox" value="YES" class="mr-2"> Pertinent Lab/Diagnostic Findings</label>
                                <label class="flex items-center font-bold text-blue-700"><input name="rod_sig_save" type="checkbox" value="YES" class="mr-2"> Signature Attached & Template Saved</label>
                            </div>
                        </div>

                        <div class="p-4 border rounded bg-yellow-50">
                            <p class="text-xs font-bold mb-3 uppercase">8. Discharge Summary (Document > Notes +):</p>
                            <div class="space-y-2 text-xs">
                                <label class="flex items-center"><input name="rod_course" type="checkbox" value="YES" class="mr-2"> Course in the Ward Added</label>
                                <label class="flex items-center font-bold text-red-700 bg-white p-1 px-2 rounded border border-red-200">
                                    <input name="rod_meds_check" type="checkbox" value="YES" class="mr-2"> Medication matches Patient Charges?
                                </label>
                                <label class="flex items-center"><input name="rod_plan_sig" type="checkbox" value="YES" class="mr-2"> Discharge Care Plan & Signatures complete</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="laboratory" class="tab-content hidden space-y-4">
                    <h4 class="text-blue-800 font-bold border-b pb-2">DEPARTMENT: LABORATORY SERVICE</h4>
                    <div class="auth-check">
                        <label class="flex items-center"><input name="acc_lab" type="checkbox" value="YES" class="w-4 h-4 mr-2" required> Active AGIMAT Lab Resulting Account Verified?</label>
                    </div>
                    <div class="p-4 bg-orange-50 border border-orange-200 rounded">
                        <p class="text-xs font-bold mb-3 uppercase">7. Clinical Records Meta-Data (Financial > Payments + > Gov Phil E-Claims):</p>
                        <div class="space-y-4">
                            <label class="flex items-center font-bold text-sm"><input name="lab_form_open" type="checkbox" value="YES" class="mr-3"> Meta Data/Clinical Records Form Populated?</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs font-semibold">
                                <label class="flex items-center border p-2 bg-white rounded"><input name="lab_instruments" type="checkbox" value="YES" class="mr-2"> Instruments Filled Up</label>
                                <label class="flex items-center border p-2 bg-white rounded"><input name="lab_tech_desc" type="checkbox" value="YES" class="mr-2"> Technical & Procedure Description</label>
                                <label class="flex items-center border p-2 bg-white rounded md:col-span-2"><input name="lab_findings" type="checkbox" value="YES" class="mr-2"> Findings and Conclusion Completed</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="radiology" class="tab-content hidden space-y-4">
                    <h4 class="text-blue-800 font-bold border-b pb-2">DEPARTMENT: RADIOLOGY SERVICE</h4>
                    <div class="auth-check">
                        <label class="flex items-center"><input name="acc_rad" type="checkbox" value="YES" class="w-4 h-4 mr-2" required> Active AGIMAT Rad Resulting Account Verified?</label>
                    </div>
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded">
                        <p class="text-xs font-bold mb-3 uppercase">7. Clinical Records Meta-Data (Financial > Payments + > Gov Phil E-Claims):</p>
                        <div class="space-y-4">
                            <label class="flex items-center font-bold text-sm"><input name="rad_form_open" type="checkbox" value="YES" class="mr-3"> Meta Data/Clinical Records Form Populated?</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs font-semibold">
                                <label class="flex items-center border p-2 bg-white rounded"><input name="rad_instruments" type="checkbox" value="YES" class="mr-2"> Instruments (Equipment) Filled</label>
                                <label class="flex items-center border p-2 bg-white rounded"><input name="rad_tech_desc" type="checkbox" value="YES" class="mr-2"> Technical & Procedure Description</label>
                                <label class="flex items-center border p-2 bg-white rounded md:col-span-2"><input name="rad_findings" type="checkbox" value="YES" class="mr-2"> Findings and Conclusion Completed</label>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="flex flex-col md:flex-row gap-4 no-print">
                <button type="submit" id="submitBtn" class="flex-[2] bg-blue-700 text-white font-bold py-5 rounded-xl hover:bg-blue-800 transition shadow-2xl uppercase tracking-tight text-lg">
                    Submit Department Audit Log
                </button>
                <button type="button" onclick="window.print()" class="flex-1 bg-white text-slate-700 border-2 border-slate-200 font-bold py-5 rounded-xl hover:bg-slate-50 transition shadow-lg uppercase text-xs">
                    üñ®Ô∏è Print Audit Copy
                </button>
            </div>
        </form>

        <p class="text-center text-[10px] text-slate-400 mt-8 no-print tracking-widest uppercase">
            Official TDMH PhilHealth Compliance Internal Tool v3.0.1
        </p>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwr5aEWStjDy51iO4DtY7vAi2Ixdi6_wPJNhG4P1B84p7rITvF2qKvH1aZgXn66jLWA2g/exec';
        const form = document.getElementById('auditForm');
        const btn = document.getElementById('submitBtn');

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabId).classList.remove('hidden');
            event.currentTarget.classList.add('active');
        }

        form.addEventListener('submit', e => {
            e.preventDefault();
            btn.disabled = true;
            btn.innerHTML = "Processing Data...";
            form.classList.add('loading');

            fetch(scriptURL, { 
                method: 'POST', 
                mode: 'no-cors', 
                body: new FormData(form)
            })
            .then(() => {
                alert('AUDIT SAVED!\nEncounter #' + form.encounter_no.value + ' has been logged to the Central Compliance Database.');
                btn.disabled = false;
                btn.innerHTML = "Submit Department Audit Log";
                form.classList.remove('loading');
                form.reset();
                showTab('admitting');
            })
            .catch(error => {
                console.error('Error!', error.message);
                alert('Submission Error. Check your connection.');
                btn.disabled = false;
                btn.innerHTML = "Submit Department Audit Log";
                form.classList.remove('loading');
            });
        });
    </script>
</body>
</html>
