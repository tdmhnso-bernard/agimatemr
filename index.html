<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TDMH AGIMAT Audit Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print { .no-print { display: none !important; } .tab-content { display: block !important; } }
        .tab-btn.active { border-bottom: 4px solid #1e40af; color: #1e40af; font-weight: bold; background-color: #f8fafc; }
        .loading { opacity: 0.5; pointer-events: none; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-800">
    <div class="max-w-6xl mx-auto py-8 px-4">
        <div class="bg-red-50 border-2 border-red-600 p-6 rounded-lg mb-8">
            <h1 class="text-xl font-bold text-red-700 uppercase mb-2">⚠️ MANDATORY COMPLIANCE NOTICE</h1>
            <p class="text-sm text-red-900">Failure to complete data encoding will result in rejected PhilHealth claims. Strict sanctions apply for non-compliance.</p>
        </div>

        <form id="auditForm">
            <div class="bg-blue-900 text-white p-6 rounded-t-lg grid grid-cols-1 md:grid-cols-4 gap-4">
                <div><label class="block text-[10px] uppercase font-bold">Auditor</label><input name="auditor" type="text" class="w-full bg-blue-800 p-2 rounded" required></div>
                <div><label class="block text-[10px] uppercase font-bold">Staff Audited</label><input name="staff_audited" type="text" class="w-full bg-blue-800 p-2 rounded" required></div>
                <div class="md:col-span-2"><label class="block text-[10px] uppercase font-bold">Encounter #</label><input name="encounter_no" type="text" class="w-full bg-blue-800 p-2 rounded" required></div>
            </div>

            <div class="flex border-b bg-white overflow-x-auto sticky top-0 z-10 no-print">
                <button type="button" onclick="showTab(event, 'admitting')" class="tab-btn active px-6 py-4 text-xs uppercase">1. Admitting</button>
                <button type="button" onclick="showTab(event, 'nurses')" class="tab-btn px-6 py-4 text-xs uppercase">2. Nurses</button>
                <button type="button" onclick="showTab(event, 'rod')" class="tab-btn px-6 py-4 text-xs uppercase">3. Resident</button>
                <button type="button" onclick="showTab(event, 'laboratory')" class="tab-btn px-6 py-4 text-xs uppercase">4. Lab</button>
                <button type="button" onclick="showTab(event, 'radiology')" class="tab-btn px-6 py-4 text-xs uppercase">5. Rad</button>
            </div>

            <div class="bg-white p-8 shadow-lg rounded-b-lg mb-8">
                <div id="admitting" class="tab-content space-y-4">
                    <h4 class="font-bold border-b pb-2 text-blue-800">ADMITTING / BILLING</h4>
                    <label class="flex items-center p-2 bg-slate-50 border rounded"><input name="acc_admitting" type="checkbox" value="YES" class="mr-2"> Account Verified?</label>
                    <label class="flex items-center"><input name="adm_1_create" type="checkbox" value="YES" class="mr-2"> 1. Create Patient Data</label>
                    <label class="flex items-center"><input name="adm_2_unlock" type="checkbox" value="YES" class="mr-2"> 2. Unlock & Sign Consent</label>
                    <label class="flex items-center font-bold"><input name="adm_4_philhealth" type="checkbox" value="YES" class="mr-2"> 4. PhilHealth Verification Saved</label>
                </div>

                <div id="nurses" class="tab-content hidden space-y-4">
                    <h4 class="font-bold border-b pb-2 text-blue-800">NURSING SERVICE</h4>
                    <label class="flex items-center p-2 bg-slate-50 border rounded"><input name="acc_nursing" type="checkbox" value="YES" class="mr-2"> Account Verified?</label>
                    <label class="flex items-center"><input name="nur_3_episode" type="checkbox" value="YES" class="mr-2"> 3. New Episode Filled</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2 p-4 bg-slate-50 rounded border">
                        <p class="col-span-full text-[10px] font-bold uppercase">5. Vital Signs:</p>
                        <label><input name="v_wt" type="checkbox" value="YES"> Wt</label><label><input name="v_ht" type="checkbox" value="YES"> Ht</label>
                        <label><input name="v_temp" type="checkbox" value="YES"> Temp</label><label><input name="v_pulse" type="checkbox" value="YES"> Pulse</label>
                        <label><input name="v_rr" type="checkbox" value="YES"> RR</label><label><input name="v_bp" type="checkbox" value="YES"> BP</label>
                        <label><input name="v_o2" type="checkbox" value="YES"> O2</label><label><input name="v_gcs" type="checkbox" value="YES"> GCS</label>
                    </div>
                    <div class="grid grid-cols-6 gap-2 p-4 bg-pink-50 rounded border">
                        <p class="col-span-full text-[10px] font-bold uppercase">OB Index:</p>
                        <label>G <input name="ob_g" type="checkbox" value="YES"></label><label>P <input name="ob_p" type="checkbox" value="YES"></label>
                        <label>T <input name="ob_t" type="checkbox" value="YES"></label><label>P <input name="ob_pt" type="checkbox" value="YES"></label>
                        <label>A <input name="ob_a" type="checkbox" value="YES"></label><label>L <input name="ob_l" type="checkbox" value="YES"></label>
                    </div>
                </div>

                <div id="rod" class="tab-content hidden space-y-4">
                    <h4 class="font-bold border-b pb-2 text-blue-800">RESIDENT ON DUTY (MD)</h4>
                    <label class="flex items-center p-2 bg-slate-50 border rounded"><input name="acc_rod" type="checkbox" value="YES" class="mr-2"> Account Verified?</label>
                    <label class="flex items-center"><input name="rod_3_ros" type="checkbox" value="YES" class="mr-2"> 3. Review of Systems Encoded</label>
                    <div class="p-4 bg-blue-50 border rounded grid grid-cols-1 md:grid-cols-2 gap-2 text-xs">
                        <p class="col-span-full font-bold uppercase">6. Clinical Abstract Checklist:</p>
                        <label><input name="rod_title" type="checkbox" value="YES" class="mr-1"> Physician Name</label>
                        <label><input name="rod_cc" type="checkbox" value="YES" class="mr-1"> Chief Complaints</label>
                        <label><input name="rod_hpi" type="checkbox" value="YES" class="mr-1"> HPI</label>
                        <label><input name="rod_clin_hist" type="checkbox" value="YES" class="mr-1"> Clinical History</label>
                        <label><input name="rod_procedures" type="checkbox" value="YES" class="mr-1"> Procedures</label>
                        <label><input name="rod_lab_findings" type="checkbox" value="YES" class="mr-1"> Lab Findings</label>
                        <label class="col-span-full font-bold text-blue-700"><input name="rod_sig_save" type="checkbox" value="YES" class="mr-1"> SIGNATURE & SAVE</label>
                    </div>
                    <div class="p-4 bg-yellow-50 border rounded text-xs space-y-2">
                        <p class="font-bold uppercase">8. Discharge Summary:</p>
                        <label class="block"><input name="rod_course" type="checkbox" value="YES" class="mr-1"> Course in Ward</label>
                        <label class="block font-bold text-red-700"><input name="rod_meds_check" type="checkbox" value="YES" class="mr-1"> Meds match Patient Charges?</label>
                        <label class="block"><input name="rod_plan_sig" type="checkbox" value="YES" class="mr-1"> Plan & Signatures</label>
                    </div>
                </div>

                <div id="laboratory" class="tab-content hidden space-y-4">
                    <h4 class="font-bold border-b pb-2 text-blue-800">LABORATORY</h4>
                    <label class="flex items-center p-2 bg-slate-50 border rounded"><input name="acc_lab" type="checkbox" value="YES" class="mr-2"> Account Verified?</label>
                    <label class="block font-bold"><input name="lab_form_open" type="checkbox" value="YES" class="mr-1"> Meta-Data Form Populated?</label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-xs">
                        <label><input name="lab_instruments" type="checkbox" value="YES" class="mr-1"> Instruments</label>
                        <label><input name="lab_tech_desc" type="checkbox" value="YES" class="mr-1"> Technical Desc</label>
                        <label><input name="lab_findings" type="checkbox" value="YES" class="mr-1"> Findings</label>
                    </div>
                </div>

                <div id="radiology" class="tab-content hidden space-y-4">
                    <h4 class="font-bold border-b pb-2 text-blue-800">RADIOLOGY</h4>
                    <label class="flex items-center p-2 bg-slate-50 border rounded"><input name="acc_rad" type="checkbox" value="YES" class="mr-2"> Account Verified?</label>
                    <label class="block font-bold"><input name="rad_form_open" type="checkbox" value="YES" class="mr-1"> Meta-Data Form Populated?</label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-xs">
                        <label><input name="rad_instruments" type="checkbox" value="YES" class="mr-1"> Equipment</label>
                        <label><input name="rad_tech_desc" type="checkbox" value="YES" class="mr-1"> Technical Desc</label>
                        <label><input name="rad_findings" type="checkbox" value="YES" class="mr-1"> Findings</label>
                    </div>
                </div>
            </div>

            <button type="submit" id="submitBtn" class="w-full bg-blue-700 text-white font-bold py-5 rounded-xl uppercase shadow-xl hover:bg-blue-800 transition">Submit Audit Log</button>
        </form>
    </div>

    <script>
        const scriptURL = 'YOUR_NEW_DEPLOYMENT_URL_HERE'; // MUST UPDATE THIS
        const form = document.getElementById('auditForm');
        const btn = document.getElementById('submitBtn');

        function showTab(e, tabId) {
            if(e) e.preventDefault();
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.remove('hidden');
            if(e) e.currentTarget.classList.add('active');
        }

        form.addEventListener('submit', e => {
            e.preventDefault();
            btn.disabled = true;
            btn.innerHTML = "Submitting...";
            
            fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: new FormData(form) })
            .then(() => {
                alert('AUDIT SAVED SUCCESSFULLY!');
                form.reset();
                btn.disabled = false;
                btn.innerHTML = "Submit Audit Log";
                showTab(null, 'admitting');
                document.querySelector('[onclick*="admitting"]').classList.add('active');
            })
            .catch(error => {
                alert('Error! Check connection.');
                btn.disabled = false;
                btn.innerHTML = "Submit Audit Log";
            });
        });
    </script>
</body>
</html>
